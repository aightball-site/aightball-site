<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AIght Ball – Narrative Forecast</title>
  <style>
    :root{
      --bg:#0d0d0d; --fg:#f2f2f2; --muted:#bbbbbb; --card:#111; --border:#333;
      --accent:#33cc99; --accent-hover:#2ab386;
      --driver:#2dd4bf; --planner:#f2c94c; --probe:#7aa0b4; --sage:#a78bfa; /* used for card borders */
      --ink:#04110d;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0; font-family:Inter,system-ui,Arial,Helvetica,sans-serif;
      background:radial-gradient(1200px 800px at 50% -10%, #1a1a1a, var(--bg));
      color:var(--fg); min-height:100vh; display:grid;
      grid-template-rows:auto auto 1fr auto; align-items:start;
    }
    .hero{ display:grid; place-items:center; padding:2rem 1.25rem .5rem; }
    .hero img{ width:min(70vw,520px); max-height:45vh; object-fit:contain; border-radius:20px;
      box-shadow:0 30px 80px rgba(0,0,0,.5); user-select:none; -webkit-user-drag:none; }

    .demo{ margin:.5rem auto 0; padding:1.25rem 1.1rem 1.6rem; border:1px solid var(--border);
      border-radius:18px; width:min(92vw, 760px); background:linear-gradient(180deg,#121212,var(--card));
      box-shadow:0 24px 50px rgba(0,0,0,.35);
    }

    .oracle-wrap{ display:grid; place-items:center; margin-bottom:.75rem; }
    .eightball{ width:min(64vw,320px); height:min(64vw,320px); border-radius:50%;
      background:radial-gradient(circle at 35% 30%, #2b2b2b 0%, #111 55%, #000 100%);
      box-shadow:inset 0 -20px 40px rgba(0,0,0,.7), 0 30px 60px rgba(0,0,0,.45);
      display:grid; place-items:center; overflow:hidden; transition:transform .2s cubic-bezier(.2,.8,.2,1); }
    .eightball .window{ width:50%; height:50%; border-radius:50%; display:grid; place-items:center;
      background:radial-gradient(circle at 50% 40%, #0b1b27, #03121c 60%, #01090e 100%);
      border:2px solid #0f2a3a; box-shadow:inset 0 0 40px rgba(0,0,0,.9); }
    .window .triangle{ position:relative; width:0; height:0; border-left:80px solid transparent; border-right:80px solid transparent; border-top:120px solid #163a5a; filter:drop-shadow(0 6px 10px rgba(0,0,0,.6)); }
    .triangle .msg{ position:absolute; top:-82px; left:50%; transform:translateX(-50%);
      width:120px; text-align:center; font-weight:800; font-size:1.05rem; letter-spacing:.4px; color:#cde7ff; text-shadow:0 1px 0 rgba(0,0,0,.5); }

    .qa{ display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; margin:1rem 0 .4rem; }
    input[type="text"]{
      padding:.85rem .95rem; border:none; border-radius:10px; min-width:300px; background:#1a1a1a; color:#fff; outline:1px solid var(--border);
    }
    button{
      padding:.9rem 1.1rem; border:none; border-radius:12px; background:var(--accent); color:var(--ink); font-weight:800; cursor:pointer;
      transition:background .15s ease, transform .08s ease, box-shadow .15s ease; box-shadow:0 8px 18px rgba(51,204,153,.25);
    }
    button:hover{ background:var(--accent-hover); } button:active{ transform:translateY(1px); }
    .helper{ color:var(--muted); text-align:center; margin:.25rem 0 .75rem; }

    /* Toggle */
    .mode-toggle{ display:flex; justify-content:center; gap:.5rem; margin:.2rem 0 .8rem; }
    .seg{
      padding:.5rem .8rem; border:1px solid var(--border); background:#171717; color:#ddd;
      border-radius:999px; font-weight:700; font-size:.85rem; cursor:pointer; transition:all .15s ease;
    }
    .seg[aria-pressed="true"]{ background:var(--accent); color:var(--ink); border-color:transparent; box-shadow:0 6px 14px rgba(51,204,153,.25); }

    .responses-wrap{ border:1px solid var(--border); border-radius:14px; background:#121212; max-height:540px; overflow:auto; padding:.6rem; }
    .responses-grid{ display:grid; grid-template-columns:1fr; gap:.6rem; }
    @media(min-width:680px){ .responses-grid.cards{ grid-template-columns:1fr 1fr; } } /* 2-col only for cards */

    .persona-card{
      border:1px solid var(--border); border-radius:12px; padding:.85rem .95rem .95rem;
      background:linear-gradient(180deg, #141414, #0f0f0f);
      transition:transform .06s ease, box-shadow .15s ease, border-color .15s ease; cursor:pointer;
    }
    .persona-card:hover{ transform:translateY(-1px); box-shadow:0 8px 16px rgba(0,0,0,.25); }
    .head{ display:flex; align-items:center; gap:.5rem; margin:0 0 .35rem; }
    .pill{ display:inline-flex; align-items:center; gap:.35rem; font-weight:800; padding:.16rem .55rem; border-radius:999px; background:var(--accent); color:var(--ink); font-size:.78rem; text-transform:uppercase; letter-spacing:.3px; }
    .pill.role{ background:#222; color:#ddd; font-weight:700; }
    .odds{ margin-left:auto; font-weight:900; font-size:.95rem; color:#cfcfcf; }
    .body{ margin:0; color:#e6e6e6; line-height:1.5; white-space:pre-wrap; }

    .card--driver{ border-color:rgba(45,212,191,.35); } /* story & likely */
    .card--planner{ border-color:rgba(242,201,76,.35); } /* alternate */
    .card--probe{ border-color:rgba(122,160,180,.35); } /* long shot */
    .card--sage{ border-color:rgba(167,139,250,.35); }  /* wildcard */

    .skeleton{ position:relative; overflow:hidden; }
    .skeleton .line{ height:12px; background:#1b1b1b; border-radius:6px; margin:.4rem 0; }
    .skeleton .line.wide{ width:92%; } .skeleton .line.med{ width:75%; } .skeleton .line.short{ width:55%; }
    .skeleton::after{ content:""; position:absolute; inset:0; background:linear-gradient(90deg, transparent, rgba(255,255,255,.06), transparent);
      animation:shimmer 1.2s infinite; }
    @keyframes shimmer{ 0%{transform:translateX(-100%);} 100%{transform:translateX(100%);} }

    footer{ margin:1.25rem 0 1.5rem; text-align:center; color:#8a8a8a; font-size:.95rem; }
    a{ color:var(--accent); text-decoration:none; } a:hover{ text-decoration:underline; }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
    .shake{ animation:wobble .6s ease-in-out; } @keyframes wobble{
      0%{transform:rotate(0) translateX(0)}20%{transform:rotate(3deg) translateX(6px)}
      40%{transform:rotate(-3deg) translateX(-6px)}60%{transform:rotate(2deg) translateX(4px)}
      80%{transform:rotate(-2deg) translateX(-4px)}100%{transform:rotate(0) translateX(0)}}
  </style>
</head>
<body>
  <section class="hero" aria-label="AIght Ball">
    <img src="Images/Logo.jpg" alt="AIght Ball logo"/>
  </section>

  <section id="demo" class="demo" role="region" aria-label="AIght Ball demo">
    <div class="oracle-wrap">
      <div class="eightball" id="orb"><div class="window"><div class="triangle"><div class="msg" id="orb-msg">ASK A QUESTION</div></div></div></div>
    </div>

    <form id="question-form" class="qa" autocomplete="off">
      <label class="sr-only" for="user-question">Ask a question</label>
      <input id="user-question" type="text" name="question" placeholder="Ask anything—decisions, dilemmas, ideas…" maxlength="200"/>
      <button type="submit" aria-label="Ask AIght Ball">Ask</button>
      <button type="button" id="shake-btn" aria-label="Shake the ball">Shake It</button>
    </form>
    <p class="helper">Tip: press Enter to ask. Or just shake for a random reading.</p>

    <!-- mode toggle -->
    <div class="mode-toggle" role="tablist" aria-label="Output mode">
      <button class="seg" data-mode="story"  role="tab" aria-selected="true"  aria-pressed="true">Story</button>
      <button class="seg" data-mode="cards"  role="tab" aria-selected="false" aria-pressed="false">Cards</button>
    </div>

    <div class="responses-wrap" aria-live="polite">
      <div id="responses" class="responses-grid"></div>
    </div>
  </section>

  <footer>
    © 2025 AIght Ball · Follow us on
    <a href="https://instagram.com/aightball.io" target="_blank" rel="noopener">Instagram</a> &
    <a href="https://youtube.com/@aightballio" target="_blank" rel="noopener">YouTube</a>
  </footer>

<script>
/* ================== DOM ================== */
const orb = document.getElementById('orb');
const orbMsg = document.getElementById('orb-msg');
const inputEl = document.getElementById('user-question');
const askBtn = document.querySelector('#question-form button[type="submit"]');
const shakeBtn = document.getElementById('shake-btn');
const responsesEl = document.getElementById('responses');
const modeBtns = document.querySelectorAll('.seg[data-mode]');
let MODE = 'story'; // default

modeBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    MODE = btn.dataset.mode;
    modeBtns.forEach(b=>{
      const active = b.dataset.mode===MODE;
      b.setAttribute('aria-selected', active);
      b.setAttribute('aria-pressed', active);
    });
    if (responsesEl.innerHTML.trim()) askOrShake();
  });
});

/* ================== UI helpers ================== */
function shakeOrb(){ orb.classList.remove('shake'); void orb.offsetWidth; orb.classList.add('shake'); }
function setLoading(on){
  askBtn.disabled = on; shakeBtn.disabled = on;
  orbMsg.textContent = on ? "…" : "ASK A QUESTION";
  responsesEl.className = 'responses-grid ' + (MODE==='cards' ? 'cards' : '');
  if(on){
    responsesEl.innerHTML = '';
    const skeleton = (cls,label)=>`
      <div class="persona-card skeleton ${cls}">
        <div class="head"><span class="pill role">${label}</span><span class="pill" style="opacity:.75">Generating…</span></div>
        <div class="line wide"></div><div class="line med"></div><div class="line short"></div>
      </div>`;
    responsesEl.innerHTML = MODE==='story'
      ? skeleton('card--driver','Story')
      : [skeleton('card--driver','Likely'),skeleton('card--planner','Alternate'),skeleton('card--probe','Long Shot'),skeleton('card--sage','Wildcard')].join('');
  }
}

/* ================== RENDERERS ================== */
function renderStory(data){
  const card = document.createElement('div');
  card.className = 'persona-card card--driver';
  const total = (data.outcomes||[]).reduce((s,o)=>s+(o.percent||0),0);
  card.innerHTML = `
    <div class="head">
      <span class="pill role">Story</span>
      <span class="pill">Unified</span>
      <span class="odds">${total}%</span>
    </div>
    <p class="body">${(data.story||'').trim()}</p>
    <div class="helper" style="margin-top:.4rem">Tap to regenerate this story</div>
  `;
  // simple re-render on click (re-ask)
  card.addEventListener('click', askOrShake);
  responsesEl.innerHTML = '';
  responsesEl.appendChild(card);
  // Optional: append deciders as a small list
  if (Array.isArray(data.deciders) && data.deciders.length){
    const meta = document.createElement('div');
    meta.className = 'persona-card';
    meta.style.borderColor = 'rgba(255,255,255,.08)';
    meta.innerHTML = `
      <div class="head"><span class="pill role">What tips the odds</span></div>
      <p class="body">• ${data.deciders.join('<br>• ')}</p>`;
    responsesEl.appendChild(meta);
  }
}

function renderCards(data){
  responsesEl.innerHTML = '';
  const map = {
    'likely':'card--driver', 'most likely':'card--driver',
    'alternate':'card--planner',
    'long shot':'card--probe',
    'wildcard':'card--sage'
  };
  (data.outcomes||[]).forEach(o=>{
    const div = document.createElement('div');
    const cls = map[(o.label||'').toLowerCase()] || 'card--driver';
    div.className = `persona-card ${cls}`;
    div.innerHTML = `
      <div class="head">
        <span class="pill role">${o.label || 'Outcome'}</span>
        <span class="pill">${(o.percent ?? '—')}%</span>
        <span class="odds"></span>
      </div>
      <p class="body">${Array.isArray(o.beats)? '• ' + o.beats.join('<br>• ') : ''}</p>
      <div class="helper" style="margin-top:.4rem">Tap to regenerate this card</div>
    `;
    div.addEventListener('click', askOrShake);
    responsesEl.appendChild(div);
  });
}

/* ================== DATA FETCH ================== */
// Replace '/api/forecast' with your actual endpoint.
async function getForecast(question){
  const res = await fetch('/api/forecast', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ question, style:'narrative', return_schema:'json_v1' })
  });
  if(!res.ok) throw new Error('API error');
  return await res.json();
}

/* ================== EVENTS ================== */
async function askOrShake(){
  const q = inputEl.value.trim() || "Surprise me";
  setLoading(true);
  try{
    const data = await getForecast(q);
    if (MODE==='story') renderStory(data); else renderCards(data);
    shakeOrb();
  } catch (e){
    responsesEl.innerHTML = `
      <div class="persona-card" style="border-color:#703;">
        <div class="head"><span class="pill role">Error</span></div>
        <p class="body">Couldn’t reach the AI service. ${e?.message || ''}</p>
      </div>`;
  } finally {
    setLoading(false);
  }
}

document.getElementById('shake-btn').addEventListener('click', askOrShake);
document.getElementById('question-form').addEventListener('submit', (e)=>{ e.preventDefault(); askOrShake(); });
</script>
</body>
</html>






















