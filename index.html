<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AIght Ball ‚Äì See the odds, not just the answer</title>
<style>
  :root{
    --bg:#0d0d0d; --fg:#f2f2f2; --muted:#bbbbbb; --card:#121212; --border:#2a2a2a;
    --accent:#33cc99; --accent-hover:#2ab386;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:radial-gradient(1000px 600px at 70% -10%, #1a1a1a 0%, #0d0d0d 55%, #070707 100%);
    color:var(--fg);
    font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    min-height:100dvh;
  }
  .wrap{max-width:1080px;margin:0 auto;padding:28px 18px 88px;display:grid;gap:28px}
  header{display:flex;align-items:center;justify-content:space-between;gap:16px}
  .brand{font-weight:800;letter-spacing:.2px}
  .tag{opacity:.8;font-size:.92rem}
  .card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:18px;overflow:hidden}

  .grid{display:grid;gap:18px}
  @media (min-width:980px){ .grid{grid-template-columns:480px 1fr} }

  /* 8-ball */
  .ball-wrap{display:flex;align-items:center;justify-content:center;padding:22px}
  .ball{
    width:300px;height:300px;border-radius:50%;position:relative;
    background:radial-gradient(circle at 40% 35%, #2f2f2f 0%, #0c0c0c 55%, #000 100%);
    box-shadow:0 30px 60px rgba(0,0,0,.55) inset, 0 14px 30px rgba(0,0,0,.55);
  }
  .shine{position:absolute;inset:0;border-radius:50%;
    background:radial-gradient(180px 120px at 70px 60px, rgba(255,255,255,.14), transparent 60%);}
  .triangle{
    position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
    width:170px;height:150px;
    background:linear-gradient(180deg,#6a49b8 0%,#5336a4 100%); /* solid gradient = no seam */
    clip-path:polygon(50% 0%, 0% 100%, 100% 100%);
    display:grid;place-items:center;
    box-shadow:0 10px 30px rgba(90,60,150,.35);
  }
  .tri-text{
    width:72%;
    font-size:12px; /* smaller so it never collides with edges */
    line-height:1.15;
    text-align:center;
    text-transform:uppercase;
    letter-spacing:.08em;
    color:#e9e1ff;
    opacity:.95;
    text-shadow:0 1px 0 rgba(0,0,0,.5);
  }

  .prompt{display:flex;gap:10px}
  input[type="text"]{flex:1;background:#0e0e0e;border:1px solid var(--border);border-radius:12px;padding:14px 14px;color:var(--fg);outline:none}
  input::placeholder{color:#8e8e8e}
  button{background:var(--accent);color:#062e22;border:none;border-radius:12px;padding:12px 14px;font-weight:700;cursor:pointer}
  button:hover{background:var(--accent-hover)}
  .hint{color:var(--muted);font-size:.9rem}

  /* Results */
  .results{display:grid;gap:12px}
  .row{
    display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;
    background:#0e0e0e;border:1px solid var(--border);border-radius:12px;padding:12px;
  }
  .answer{font-weight:600}
  .bar{height:8px;border-radius:999px;background:#1b1b1b;overflow:hidden;margin-top:8px}
  .fill{height:100%;background:linear-gradient(90deg, #33cc99, #2ab386)}
  .pct{font-variant-numeric:tabular-nums;font-weight:800;opacity:.9}

  .tone{display:flex;align-items:center;gap:8px}
  .tone select{background:#0e0e0e;color:var(--fg);border:1px solid var(--border);border-radius:10px;padding:8px}

  /* subtle shake */
  .ball.shake{animation:shake .6s ease}
  @keyframes shake{
    0%{transform:translate(0,0) rotate(0)}
    20%{transform:translate(-3px,-2px) rotate(-1deg)}
    40%{transform:translate(3px,2px) rotate(1deg)}
    60%{transform:translate(-2px,1px) rotate(0deg)}
    80%{transform:translate(2px,-1px) rotate(1deg)}
    100%{transform:translate(0,0) rotate(0)}
  }

  /* clean up: remove the feature blurbs that were causing visual ‚Äúghosts‚Äù */
  .badges{display:flex;gap:10px;flex-wrap:wrap}
  .chip{border:1px solid var(--border);padding:6px 10px;border-radius:999px;background:#0e0e0e;color:var(--muted);font-size:.9rem}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <div class="brand">AIght Ball</div>
        <div class="tag">See the odds, not just the answer.</div>
      </div>
      <div class="tone card" style="padding:10px 12px;">
        <span style="opacity:.8;">Tone:</span>
        <select id="toneSelect" aria-label="Tone">
          <option value="friend">Helpful Friend</option>
          <option value="confidant">Empathetic Confidant</option>
          <option value="counselor">Supportive Counselor</option>
          <option value="gm">Cinematic GM</option>
          <option value="altHistory">Alt-History Guide</option>
          <option value="auto">Auto (detect)</option>
        </select>
      </div>
    </header>

    <div class="grid">
      <!-- Left: Ball -->
      <div class="card ball-wrap">
        <div class="ball" id="ball">
          <div class="shine"></div>
          <div class="triangle"><div class="tri-text" id="ballText">See your fate below</div></div>
        </div>
      </div>

      <!-- Right: Controls + Results -->
      <div class="card">
        <div class="grid">
          <div class="prompt">
            <input id="question" type="text" placeholder="Ask anything‚Ä¶ (e.g., 'I live in Boston and want Italian')" />
            <button id="askBtn">Ask</button>
          </div>

          <!-- small, non-intrusive badges (replaces the big blurbs) -->
          <div class="badges">
            <span class="chip">Multi-outcomes sum to 100%</span>
            <span class="chip">Heuristics now, API-ready</span>
            <span class="chip">Tone ladder applied</span>
          </div>

          <div class="results" id="results"></div>
          <div class="hint" id="localTip" style="display:none;"></div>
        </div>
      </div>
    </div>
  </div>

<script>
/* =========================
   Core knobs
   ========================= */
const DEFAULT_OUTCOME_COUNT = 3;
const MIN_PCT = 7;
const USE_DIRICHLET = true;

/* =========================
   Tone Ladder (scaffold)
   ========================= */
const toneRenderers = {
  friend: (q, line) =>
    `${line} (I‚Äôve got your back‚Äîpick what feels light and doable.)`,
  confidant: (q, line) =>
    `${line} You‚Äôve got a few good paths here; consider energy & boundaries.`,
  counselor: (q, line) =>
    `${line} If this touches something heavy, choose the gentlest next step.`,
  gm: (q, line) =>
    `üé≤ ${line} ‚Äî the scene shifts as you decide; fortune favors momentum.`,
  altHistory: (q, line) =>
    `${line} Imagine two timelines; the differential grows with each choice.`,
};

function chooseTone(question, explicit) {
  if (explicit && explicit !== 'auto') return explicit;
  const q = (question || '').toLowerCase();
  const heavy = /(break up|divorce|death|grief|diagnos|fired|pregnan|addict|panic|abuse|unsafe)/.test(q);
  const life  = /(should i|move|quit|career|marry|have kid|college|sell|buy)/.test(q);
  const rpg   = /(dragon|goblin|quest|roll|dice|dungeon|campaign)/.test(q);
  const alt   = /(what if|counterfactual|alternate|if .* had)/.test(q);
  if (rpg) return 'gm';
  if (alt) return 'altHistory';
  if (heavy) return 'counselor';
  if (life) return 'confidant';
  return 'friend';
}

/* =========================
   Outcome generator
   ========================= */
const templateBuckets = {
  generic: [
    "Go for it",
    "Wait & gather more info",
    "Pivot to a simpler version",
    "Say no (protect your time)",
    "Ask someone you trust first"
  ],
  dining: [
    "Budget-friendly comfort",
    "Classic, reliable spot",
    "Hidden neighborhood gem",
    "Trendy pick with a vibe",
    "Make it at home tonight"
  ]
};

function pickTemplates(question, n) {
  const q = (question || '').toLowerCase();
  let pool = templateBuckets.generic;
  if (/food|restaurant|dinner|lunch|eat|italian|sushi|tacos|pizza|thai|ramen|bbq|indian|greek/.test(q)) {
    pool = templateBuckets.dining;
  }
  const copy = [...pool], out = [];
  for (let i=0; i<n && copy.length; i++){
    const idx = Math.floor(Math.random()*copy.length);
    out.push(copy.splice(idx,1)[0]);
  }
  return out;
}

function splitPercentages(n, minEach=MIN_PCT) {
  const totalMin = n * minEach;
  if (totalMin > 100) {
    const eq = Math.floor(100/n);
    const arr = Array(n).fill(eq);
    arr[0] += 100 - eq*n;
    return arr;
  }
  const remaining = 100 - totalMin;
  if (USE_DIRICHLET) {
    const gammas = Array.from({length:n},()=> -Math.log(Math.random()));
    const sum = gammas.reduce((s,x)=>s+x,0) || 1;
    const shares = gammas.map(g => g/sum);
    let pcts = shares.map(s => Math.floor(s*remaining));
    let used = pcts.reduce((s,x)=>s+x,0);
    for (let i=0; i<remaining-used; i++) pcts[i%pcts.length]++;
    return pcts.map(v => v + minEach);
  } else {
    const cuts = Array.from({length:n-1}, ()=>Math.random()).sort((a,b)=>a-b);
    const parts = []; let prev = 0;
    for (const c of cuts){ parts.push(c - prev); prev = c; }
    parts.push(1 - prev);
    let pcts = parts.map(p => Math.floor(p*remaining));
    let used = pcts.reduce((s,x)=>s+x,0);
    for (let i=0; i<remaining-used; i++) pcts[i%pcts.length]++;
    return pcts.map(v => v + minEach);
  }
}

/* =========================
   Lightweight local intent
   ========================= */
function detectCityCuisine(question){
  const q = (question||'').toLowerCase();
  const city = (q.includes('boston') ? 'Boston' : null);
  const cuisineMatch = q.match(/italian|sushi|thai|pizza|tacos|ramen|bbq|indian|greek|mediterranean/);
  return { city, cuisine: cuisineMatch ? cuisineMatch[0] : null };
}

/* =========================
   Rendering
   ========================= */
const elResults = document.getElementById('results');
const elBall = document.getElementById('ball');
const elBallText = document.getElementById('ballText');
const elLocalTip = document.getElementById('localTip');

function renderResults(question, toneKey) {
  elResults.innerHTML = '';

  const outcomes = pickTemplates(question, DEFAULT_OUTCOME_COUNT);
  const pcts = splitPercentages(outcomes.length);
  const { city, cuisine } = detectCityCuisine(question);
  const tone = toneRenderers[toneKey] ? toneKey : 'friend';

  outcomes
    .map((label, i) => ({ label, pct: pcts[i] }))
    .sort((a,b) => b.pct - a.pct)
    .forEach(({label, pct}) => {
      const row = document.createElement('div'); row.className='row';

      const left = document.createElement('div');
      const ans = document.createElement('div'); ans.className='answer';
      ans.textContent = toneRenderers[tone](question, label);

      const bar = document.createElement('div'); bar.className='bar';
      const fill = document.createElement('div'); fill.className='fill'; fill.style.width = pct + '%';
      bar.appendChild(fill);

      left.appendChild(ans);
      left.appendChild(bar);

      const right = document.createElement('div'); right.className='pct'; right.textContent = `${pct}%`;

      row.appendChild(left); row.appendChild(right);
      elResults.appendChild(row);
    });

  if (city || cuisine){
    const want = cuisine ? cuisine : 'good';
    const where = city ? `in ${city}` : 'near you';
    elLocalTip.style.display = 'block';
    elLocalTip.textContent = `üîú Local picks scaffolded: ‚ÄúFind ${want} spots ${where}.‚Äù (We‚Äôll wire Google Places/Yelp soon.)`;
  } else {
    elLocalTip.style.display = 'none';
  }
}

/* =========================
   Events
   ========================= */
document.getElementById('askBtn').addEventListener('click', run);
document.getElementById('question').addEventListener('keydown', e=>{
  if (e.key === 'Enter') run();
});
function run(){
  const q = document.getElementById('question').value.trim();
  const toneSel = document.getElementById('toneSelect').value;
  const tone = chooseTone(q, toneSel);
  elBall.classList.remove('shake'); void elBall.offsetWidth; elBall.classList.add('shake');
  elBallText.textContent = 'See your fate below';
  renderResults(q, tone);
}
renderResults('', 'friend');
</script>
</body>
</html>





